@page "/updatepasswords"


<button @onclick = "updatePasswords">update passwords</button>

@code 
{
    string finalString = "";


    private void updatePasswords()
    {
        Mongo mongo = new Mongo("college-site-2");
        var chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
        var stringChars = new char[8];
        var random = new Random();


        var list = new List<string> { };
        var counter = 0;
        for (int i = 0; i < 5000; i++)
        {
            for (int j = 0; j < stringChars.Length; j++)
            {
                stringChars[j] = chars[random.Next(chars.Length)];
            }

            finalString = new String(stringChars);
            list.Add(finalString);
            Console.WriteLine($"counter1: {counter}   {list[counter]}");
            counter++;

        }

        var userQuery = mongo.LoadRecord<AllUser>("allUser");
        var advisorQuery = mongo.LoadRecord<Advisor>("advisor");


        int counter2 = 0;
        Console.WriteLine("before write");
        foreach (var user in userQuery)
        {
            Console.WriteLine($"{list.Count}");
            Console.WriteLine($"before: {user.Password}");
            user.Password = list[counter2];
            mongo.UpsertRecord<AllUser>("allUser", user.Id, user);
            Console.WriteLine($"after: {user.Password}");
            Console.WriteLine($"counter2 {counter2}   {list[counter2]}");
            counter2++;

        }

        foreach (var advisor in advisorQuery)
        {
            Console.WriteLine($"{list.Count}");
            Console.WriteLine($"before: {advisor.Password}");
            advisor.Password = list[counter2];
            mongo.UpsertRecord<Advisor>("advisor", advisor.Id, advisor);
            Console.WriteLine($"after: {advisor.Password}");
            Console.WriteLine($"counter2 {counter2}   {list[counter2]}");
            counter2++;
        }

        }

    //private void updatePasswords()
    //{
    //    Mongo mongo = new Mongo("college-site-2");
    //    var chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
    //    var stringChars = new char[8];
    //    var random = new Random();

    //    for (int i = 0; i < stringChars.Length; i++)
    //    {
    //        stringChars[i] = chars[random.Next(chars.Length)];
    //    }

    //    finalString = new String(stringChars);

    //    var userQuery = mongo.LoadRecord<AllUser>("allUser");
    //    var list = new List<string> { };
    //    var count = 0;
    //    foreach (var user in userQuery)
    //    {
    //        list.Add(finalString);
    //        count++;
    //    }
    //    loadList = $"list loaded {count}";
    //    int counter = 0;
    //    int count2 = 0;
    //    foreach (var user in userQuery)
    //    {
    //        user.Password = list[counter];
    //        finalString = $"{list[counter]}";
    //        count2++;
    //        counter++;
    //    }
    //    loadDB = "database loaded";
    //}
}
